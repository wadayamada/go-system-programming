# 学んだこと
- OSから見るとタイマーやカウンタは、タスクのCPUへの割り当てや、I/Oのスケジューリングやタイムアウト、ファイルのタイムスタンプなど色々な箇所で使っており、重要
- OSが起動されるとリアルタイムクロックから現在時刻を取得して、システムクロックを合わせる
  - リアルタイムクロックは電源を落としても消えないが、システムクロックは電源を落とすと消える
- ハードウェアのタイマーでLinuxだと1秒間に250回割り込みが発生する。これを使ってシステムクロックの更新や、プロセスのタイムスライスを減らしたり、実行するタスクを切り替えたりする
- 適宜調整しながら正しい時間を表示するのがリアルタイム時刻、調整の影響を受けたく巻き戻しが発生しない場合はモノトニック時刻
- ウォールクロック時間は普段人間が使ってる時間で、CPU時間はCPUの実行時間。10%だったら1/10
- runtime.nowで現在時刻を取得できる
  - linuxではclock_gettimeというシステムコールで現在時刻を取得する
  - vDSOという仕組みを使ってオーバーヘッドのコストを減らしている
  - linuxではハードウェアタイマーのイベントハンドラでupdate_vsyscallが呼ばれるようにして、時刻を更新してる
- スリープではruntime.samesleepが呼ばれている
  - これはセマフォの獲得待ちのタイムアウトでタイマーを実装してる
  - タイマーが期限の短い順で並んでおり、最新のタイマーが時間経過後にタイムアウトされ、タイマーが発火する。発火したら次のタイマーのタイムアウト待ちになる。
  - runtime.semawaitによって、セマフォのタイムアウト10秒待ちの後に5秒が設定された場合、5秒でタイムアウトを上書きできるらしい

# 面白かったこと
- time.Timeはモノトニック時刻も内包する。time.Addで計算した場合、リアルタイム時刻の再計算が入っても反映されないが、time.AddDateには反映されるらしい

# わからなかったこと
- セマフォを使ったタイマーがわかったようなわからないような
- チャネルを使って、シグナルやタイマーを処理してるらしいがピンとこない
